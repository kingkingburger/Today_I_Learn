

#### JWT (JSON Web Token)

![κ°λ° μ§€μ‹/WEB μ§€μ‹](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fbmtdsy%2FbtrqApuPlmS%2FgEE45964H9LPXwm2OxROSk%2Fimg.png)

JWT(JSON Web Token)λ€ `μΈμ¦μ— ν•„μ”ν• μ •λ³΄λ“¤μ„ μ•”νΈν™”μ‹ν‚¨ JSON ν† ν°`μ„ μλ―Έν•λ‹¤.
κ·Έλ¦¬κ³  JWT κΈ°λ° μΈμ¦μ€ JWT ν† ν°(Access Token)μ„ `HTTP ν—¤λ”`μ— μ‹¤μ–΄ `μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‹λ³„ν•λ” λ°©μ‹`μ΄λ‹¤

JWTλ” JSON λ°μ΄ν„°λ¥Ό **Base64 URL-safe Encode** λ¥Ό ν†µν•΄ μΈμ½”λ”©ν•μ—¬ μ§λ ¬ν™”(μΌμλ΅ μ­‰)ν• κ²ƒμ΄λ©°, ν† ν° λ‚΄λ¶€μ—λ” μ„λ³€μ΅° λ°©μ§€λ¥Ό μ„ν•΄ κ°μΈν‚¤λ¥Ό ν†µν• **μ „μμ„λ…**λ„ λ“¤μ–΄μλ‹¤.
λ”°λΌμ„ μ‚¬μ©μκ°€ JWT λ¥Ό μ„λ²„λ΅ μ „μ†΅ν•λ©΄ **μ„λ²„λ” μ„λ…μ„ κ²€μ¦ν•λ” κ³Όμ •**μ„ κ±°μΉκ² λλ©° κ²€μ¦μ΄ μ™„λ£λλ©΄ μ”μ²­ν• μ‘λ‹µμ„ λλ ¤μ¤€λ‹¤.

> Base64 URL-safe Encodeλ€?
>
> Base64 URL-safe Encode λ” μΌλ°μ μΈ Base64 Encode μ—μ„ URL μ—μ„ μ¤λ¥μ—†μ΄ μ‚¬μ©ν•λ„λ΅ '+', '/' λ¥Ό κ°κ° '-', '_' λ΅ ν‘ν„ν• κ²ƒμ΄λ‹¤.



#### JWT κµ¬μ΅°

JWTλ” . μ„ κµ¬λ¶„μλ΅ λ‚λ„μ–΄μ§€λ” μ„Έ κ°€μ§€ λ¬Έμμ—΄μ μ΅°ν•©μ΄λ‹¤.
. μ„ κΈ°μ¤€μΌλ΅ μΆμΈ΅λ¶€ν„° Header, Payload, Signatureλ¥Ό μλ―Έν•λ‹¤.

![json-web-token](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbwmwBq%2FbtrqGVel5Qk%2FnPIPkduUJk2xT8Lv00FPb0%2Fimg.png)

**Header** μ—λ” JWT μ—μ„ μ‚¬μ©ν•  νƒ€μ…κ³Ό ν•΄μ‹ μ•κ³ λ¦¬μ¦μ μΆ…λ¥κ°€ λ‹΄κ²¨μμµλ‹λ‹¤ 

**Payload** λ” μ„λ²„μ—μ„ μ²¨λ¶€ν• μ‚¬μ©μ κ¶ν• μ •λ³΄μ™€ λ°μ΄ν„°κ°€ λ‹΄κ²¨μμµλ‹λ‹¤.

**Signature** μ—λ” Header, Payload λ¥Ό Base64 URL-safe Encode λ¥Ό ν• μ΄ν›„ Header μ— λ…μ‹λ ν•΄μ‹ν•¨μλ¥Ό μ μ©ν•κ³ , κ°μΈν‚¤(Private Key)λ΅ μ„λ…ν• μ „μμ„λ…μ΄ λ‹΄κ²¨μμµλ‹λ‹¤.

μ „μμ„λ…μ—λ” **λΉ„λ€μΉ­ μ•”νΈν™” μ•κ³ λ¦¬μ¦**μ„ μ‚¬μ©ν•λ―€λ΅ μ•”νΈν™”λ¥Ό μ„ν• ν‚¤μ™€ λ³µνΈν™”λ¥Ό μ„ν• ν‚¤κ°€ λ‹¤λ¥΄λ‹¤. μ•”νΈν™”(μ „μμ„λ…)μ—λ” κ°μΈν‚¤λ¥Ό, λ³µνΈν™”(κ²€μ¦)μ—λ” κ³µκ°ν‚¤λ¥Ό μ‚¬μ©ν•λ‹¤.



μμ„Έν μ•μ•„λ΄…μ‹λ‹¤.

#### **Header**

![json-web-token](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbxGWdp%2FbtrqApn8yE5%2FjWJFUxLUAGKW4qncSKUcyk%2Fimg.png)

- alg : μ„λ… μ•”νΈν™” μ•κ³ λ¦¬μ¦(ex: HMAC SHA256, RSA)
- typ : ν† ν° μ ν•



**Payload**

![json-web-token](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FSsJJz%2FbtrqAVmHOSN%2F65OmpdL0CxUJwvhDgncaI1%2Fimg.png)

ν† ν°μ—μ„ μ‚¬μ©ν•  μ •λ³΄μ μ΅°κ°λ“¤μΈ **Claim** μ΄ λ‹΄κ²¨μλ‹¤. `(μ‹¤μ  JWT λ¥Ό ν†µν•΄μ„ μ• μ μλ” λ°μ΄ν„°)`
μ¦‰, μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈκ°€ μ£Όκ³ λ°›λ” **μ‹μ¤ν…μ—μ„ μ‹¤μ λ΅ μ‚¬μ©λ  μ •λ³΄μ— λ€ν• λ‚΄μ©μ„ λ‹΄κ³  μλ” μ„Ήμ…**μ΄λ‹¤.

νμ΄λ΅λ“λ” μ •ν•΄μ§„ λ°μ΄ν„° νƒ€μ…μ€ μ—†μ§€λ§, λ€ν‘μ μΌλ΅ Registered claims, Public claims, Private claims μ΄λ ‡κ² μ„Έ κ°€μ§€λ΅ λ‚λ‰λ‹¤.

μ¶μ²: https://inpa.tistory.com/entry/WEB-π“-JWTjson-web-token-λ€-π’―-μ •λ¦¬ [π‘¨β€π’» Dev Scroll:ν‹°μ¤ν† λ¦¬]

![json-web-token](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FmgfVm%2FbtrqCTBYYnU%2FC8HHxa7hhNu94ivkq2xKK1%2Fimg.png)

- Registed claims : λ―Έλ¦¬ μ •μλ ν΄λ μ„.

  - iss(issuer; λ°ν–‰μ), 

  - exp(expireation time; λ§λ£ μ‹κ°„), 

  - sub(subject; μ λ©), 

  - iat(issued At; λ°ν–‰ μ‹κ°„), 

  - jti(JWI ID)

- Public claims : μ‚¬μ©μκ°€ μ •μν•  μ μλ” ν΄λ μ„ κ³µκ°μ© μ •λ³΄ μ „λ‹¬μ„ μ„ν•΄ μ‚¬μ©.
- Private claims : ν•΄λ‹Ήν•λ” λ‹Ήμ‚¬μλ“¤ κ°„μ— μ •λ³΄λ¥Ό κ³µμ ν•κΈ° μ„ν•΄ λ§λ“¤μ–΄μ§„ μ‚¬μ©μ μ§€μ • ν΄λ μ„. μ™Έλ¶€μ— κ³µκ°λλ„ μƒκ΄€μ—†μ§€λ§ ν•΄λ‹Ή μ μ €λ¥Ό νΉμ •ν•  μ μλ” μ •λ³΄λ“¤μ„ λ‹΄λ”λ‹¤

μ¶μ²: https://inpa.tistory.com/entry/WEB-π“-JWTjson-web-token-λ€-π’―-μ •λ¦¬ [π‘¨β€π’» Dev Scroll:ν‹°μ¤ν† λ¦¬]

#### **Signature**

![json-web-token](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FmfFwR%2FbtrqGscsGzU%2Fj4kxvr7ZQKbJgxQLOBJIP0%2Fimg.png)

- μ‹κ·Έλ‹μ²μ—μ„ μ‚¬μ©ν•λ” μ•κ³ λ¦¬μ¦μ€ ν—¤λ”μ—μ„ μ •μν• **μ•κ³ λ¦¬μ¦ λ°©μ‹(alg)**μ„ ν™μ©ν•λ‹¤.
- μ‹κ·Έλ‹μ²μ κµ¬μ΅°λ” (ν—¤λ” + νμ΄λ΅λ“)μ™€ μ„λ²„κ°€ κ°–κ³  μλ” μ μΌν• key κ°’μ„ ν•©μΉ κ²ƒμ„ ν—¤λ”μ—μ„ μ •μν• μ•κ³ λ¦¬μ¦μΌλ΅ μ•”νΈν™”λ¥Ό ν•λ‹¤.

![json-web-token](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FciuEZW%2FbtrqGUNpW5k%2FtTa44GLQ4LzQhgD9gpb4j1%2Fimg.png)

μ”μ•½ν•λ©΄ μ„ κ·Έλ¦Όκ³Ό κ°™μµλ‹λ‹¤

```
Headerμ™€ Payloadλ” λ‹¨μν μΈμ½”λ”©λ κ°’μ΄κΈ° λ•λ¬Έμ— μ  3μκ°€ λ³µνΈν™” λ° μ΅°μ‘ν•  μ μμ§€λ§, Signatureλ” μ„λ²„ μΈ΅μ—μ„ κ΄€λ¦¬ν•λ” λΉ„λ°€ν‚¤κ°€ μ μ¶λμ§€ μ•λ” μ΄μƒ λ³µνΈν™”ν•  μ μ—†λ‹¤.
λ”°λΌμ„ Signatureλ” ν† ν°μ μ„λ³€μ΅° μ—¬λ¶€λ¥Ό ν™•μΈν•λ”λ° μ‚¬μ©λλ‹¤.
```

### **JWTλ¥Ό μ΄μ©ν• μΈμ¦ κ³Όμ •**

![json-web-token](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Ft2DrY%2FbtrqGTOykhT%2FbpeE1EZ0YeP9xIec1uU9g0%2Fimg.png)

1. μ‚¬μ©μκ°€ ID, PWλ¥Ό μ…λ ¥ν•μ—¬ μ„λ²„μ— λ΅κ·ΈμΈ μΈμ¦μ„ μ”μ²­ν•λ‹¤.
2. μ„λ²„μ—μ„ ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° μΈμ¦ μ”μ²­μ„ λ°›μΌλ©΄, Header, PayLoad, Signatureλ¥Ό μ •μν•λ‹¤.Hedaer, PayLoad, Signatureλ¥Ό κ°κ° Base64λ΅ ν• λ² λ” μ•”νΈν™”ν•μ—¬ JWTλ¥Ό μƒμ„±ν•κ³  μ΄λ¥Ό μΏ ν‚¤μ— λ‹΄μ•„ ν΄λΌμ΄μ–ΈνΈμ—κ² λ°κΈ‰ν•λ‹¤.
3. ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„λ΅λ¶€ν„° λ°›μ€ JWTλ¥Ό λ΅μ»¬ μ¤ν† λ¦¬μ§€μ— μ €μ¥ν•λ‹¤. (μΏ ν‚¤λ‚ λ‹¤λ¥Έ κ³³μ— μ €μ¥ν•  μλ„ μμ)APIλ¥Ό μ„λ²„μ— μ”μ²­ν• λ• **Authorization headerμ— Access Token**μ„ λ‹΄μ•„μ„ λ³΄λ‚Έλ‹¤.
4. μ„λ²„κ°€ ν•  μΌμ€ ν΄λΌμ΄μ–ΈνΈκ°€ Headerμ— λ‹΄μ•„μ„ λ³΄λ‚Έ JWTκ°€ λ‚΄ μ„λ²„μ—μ„ λ°ν–‰ν• ν† ν°μΈμ§€ μΌμΉ μ—¬λ¶€λ¥Ό ν™•μΈν•μ—¬ μΌμΉν•λ‹¤λ©΄ μΈμ¦μ„ ν†µκ³Όμ‹μΌμ£Όκ³  μ•„λ‹λΌλ©΄ ν†µκ³Όμ‹ν‚¤μ§€ μ•μΌλ©΄ λλ‹¤.μΈμ¦μ΄ ν†µκ³Όλμ—μΌλ―€λ΅ νμ΄λ΅λ“μ— λ“¤μ–΄μλ” μ μ €μ μ •λ³΄λ“¤μ„ selectν•΄μ„ ν΄λΌμ΄μ–ΈνΈμ— λλ ¤μ¤€λ‹¤.
5. ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ— μ”μ²­μ„ ν–λ”λ°, λ§μΌ μ•΅μ„Έμ¤ ν† ν°μ μ‹κ°„μ΄ λ§λ£λλ©΄ ν΄λΌμ΄μ–ΈνΈλ” λ¦¬ν”„λμ‹ ν† ν°μ„ μ΄μ©ν•΄μ„
6. μ„λ²„λ΅λ¶€ν„° μƒλ΅μ΄ μ—‘μ„Έμ¤ ν† ν°μ„ λ°κΈ‰ λ°›λ”λ‹¤.



#### ν† ν° μΈμ¦ μ‹ λΆ°μ„±μ„ κ°€μ§€λ” μ΄μ 

μ μ € JWT: A(Header) + B(Payload) + C(Signature) μΌ λ• (λ§μΌ μ„μμ μ μ €κ°€ Bλ¥Ό μμ •ν–λ‹¤κ³  ν•λ©΄ B'λ΅ ν‘μ‹ν•λ‹¤.)

1. λ‹¤λ¥Έ μ μ €κ°€ Bλ¥Ό μ„μλ΅ μμ • -> μ μ € JWT: A + **B'** + C
2. μμ •ν• ν† ν°μ„ μ„λ²„μ— μ”μ²­μ„ λ³΄λ‚΄λ©΄ μ„λ²„λ” μ ν¨μ„± κ²€μ‚¬ μ‹ν–‰
   - μ μ € JWT: A + **B'** + C
   - μ„λ²„μ—μ„ κ²€μ¦ ν›„ μƒμ„±ν• JWT: A + **B'** + C' => (signature) λ¶μΌμΉ
3.  λ€μ΅° κ²°κ³Όκ°€ μΌμΉν•μ§€ μ•μ•„ μ μ €μ μ •λ³΄κ°€ μ„μλ΅ μ΅°μ‘λμ—μμ„ μ• μ μλ‹¤.

μ •λ¦¬ν•μλ©΄, μ„λ²„λ” ν† ν° μ•μ— λ“¤μ–΄μλ” μ •λ³΄κ°€ λ¬΄μ—‡μΈμ§€ μ•„λ”κ² μ¤‘μ”ν• κ²ƒμ΄ μ•„λ‹λΌ ν•΄λ‹Ή ν† ν°μ΄ μ ν¨ν• ν† ν°μΈμ§€ ν™•μΈν•λ” κ²ƒμ΄ μ¤‘μ”ν•κΈ° λ•λ¬Έμ—, ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° λ°›μ€ JWTμ ν—¤λ”, νμ΄λ΅λ“λ¥Ό μ„λ²„μ keyκ°’μ„ μ΄μ©ν•΄ μ‹κ·Έλ‹μ²λ¥Ό λ‹¤μ‹ λ§λ“¤κ³  μ΄λ¥Ό λΉ„κµν•λ©° μΌμΉν–μ„ κ²½μ° μΈμ¦μ„ ν†µκ³Όμ‹ν‚¨λ‹¤.



#### JWT μ¥μ 

1. Headerμ™€ Payloadλ¥Ό κ°€μ§€κ³  Signatureλ¥Ό μƒμ„±ν•λ―€λ΅ **λ°μ΄ν„° μ„λ³€μ΅°λ¥Ό λ§‰μ„ μ μλ‹¤.**
2. μΈμ¦ μ •λ³΄μ— λ€ν• **λ³„λ„μ μ €μ¥μ†κ°€ ν•„μ”μ—†λ‹¤.**
3. JWTλ” ν† ν°μ— λ€ν• κΈ°λ³Έ μ •λ³΄μ™€ μ „λ‹¬ν•  μ •λ³΄ λ° ν† ν°μ΄ κ²€μ¦λ¬μμ„ μ¦λ…ν•λ” μ„λ… λ“± ν•„μ”ν• λ¨λ“  μ •λ³΄λ¥Ό μμ²΄μ μΌλ΅ μ§€λ‹κ³  μλ‹¤.
4. ν΄λΌμ΄μ–ΈνΈ μΈμ¦ μ •λ³΄λ¥Ό μ €μ¥ν•λ” μ„Έμ…κ³Ό λ‹¤λ¥΄κ², **μ„λ²„λ” λ¬΄μƒνƒ(StateLess)**κ°€ λλ‹¤.
5. ν™•μ¥μ„±μ΄ μ°μν•λ‹¤.
6. ν† ν° κΈ°λ°μΌλ΅ **λ‹¤λ¥Έ λ΅κ·ΈμΈ μ‹μ¤ν…μ— μ ‘κ·Ό λ° κ¶ν• κ³µμ κ°€ κ°€λ¥ν•λ‹¤. (μΏ ν‚¤μ™€ μ°¨μ΄)**
7. OAuthμ κ²½μ° Facebook, Google λ“± μ†μ… κ³„μ •μ„ μ΄μ©ν•μ—¬ λ‹¤λ¥Έ μ›Ήμ„λΉ„μ¤μ—μ„λ„ λ΅κ·ΈμΈμ„ ν•  μ μλ‹¤.
8. λ¨λ°”μΌ μ–΄ν”λ¦¬μΌ€μ΄μ… ν™κ²½μ—μ„λ„ μ λ™μ‘ν•λ‹¤. (λ¨λ°”μΌμ€ μ„Έμ… μ‚¬μ© λ¶κ°€λ¥)

```
μ„λ²„μ—μ„ κ°€μ¥ ν”Όν•΄μ•Ό ν•  κ²ƒμ€ λ°μ΄ν„°λ² μ΄μ¤ μ΅°νμ΄λ‹¤.
μ„λ²„ μμ²΄κ°€ μ£½λ” κ²½μ°λ„ μμ§€λ§, λ€λ¶€λ¶„ DBκ°€ ν„°μ Έμ„ μ„λ²„λ„ κ°™μ΄ μ£½λ” κ²½μ°κ°€ ν—λ‹¤ν•κΈ° λ•λ¬Έμ΄λ‹¤.
μ΄λ° μ μ—μ„, JWT ν† ν°μ€ DBμ΅°νλ¥Ό μ•ν•΄λ„ λλ” μ¥μ μ„ κ°€μ§€κ³  μλ‹¤λ” μ μ΄λ‹¤.
λ§μΌ payloadμ— μ μ €μ΄λ¦„κ³Ό μ μ €λ“±κΈ‰ μ„ κ°™μ΄ λ‘κ³  λ³΄λ‚΄λ©΄, μ„λ²„μ—μ„λ” μ μ €μ΄λ¦„μ„ κ°€μ§€κ³  DBλ¥Ό μ΅°νν•΄μ„ μ μ € λ“±κΈ‰μ„ μ–»μ§€μ•μ•„λ„ λ°”λ΅ μ›ν•λ” μ •λ³΄λ¥Ό μ·¨ν• μ μλ‹¤.
```



#### μ¶μ²

https://inpa.tistory.com/entry/WEB-π“-JWTjson-web-token-λ€-π’―-μ •λ¦¬ [π‘¨β€π’» Dev Scroll:ν‹°μ¤ν† λ¦¬]